---
title: "scratch work"
author: "Carine Hajjar"
date: "4/17/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Figure 1: stan_glm and sigma instead of lm and 95% confidence interval
Below I recreate figure 1 with a stan_glm regression rather than a linear regression. I also use sigma as the measure of uncertainty rather than the 95% confidence interval. It shows a different measure of uncertainty that reveals larger levels of variance for each estimated treatment effect. 
```{r}
# We are looking to see the effect of different cues (liberal, conservative, and conservative from congress) on Republicans, Democrats, and Independents. 
# Regression for average treatment effects of a conservative, liberal, and congression conservative cue among Republicans:
# With each of the regressions, we see data filtered for Republicans:
#conservative treatment
model1 <- stan_glm(Support ~ contrump, data = data[data$republican == 1 & (data$contrump == 1 | data$self == 1),], refresh = 0, family = "binomial")

#liberal treatment
model2 <- stan_glm(Support ~ libtrump, data = data[data$republican == 1 & (data$libtrump == 1 | data$self == 1),], refresh = 0, family = "binomial")
#GOP treatment
model3 <- stan_glm(support_gop ~ gopleader, data = data[data$republican == 1 & (data$gopleader == 1 | data$self == 1),], refresh = 0, family = "binomial")
# ****MISTAKE**** in the paper, figure 1 has the treatment effect of about -0.03 on the conservatives yet the outcome is 0.008
# Regression for average treatment effects of a conservative, liberal, and congression conservative cue among Democrats:
# With each of the regressions, we see data filtered for Democrats:
#conservative treatment
model1dem <- stan_glm(Support ~ contrump, data = data[data$democrat == 1 & (data$contrump == 1 | data$self == 1),], refresh = 0, family = "binomial")
#liberal treatment
model2dem <- stan_glm(Support ~ libtrump, data = data[data$democrat == 1 & (data$libtrump == 1 | data$self == 1),], refresh = 0, family = "binomial")
#GOP treatment
model3dem <- stan_glm(support_gop ~ gopleader, data = data[data$democrat == 1 & (data$gopleader == 1 | data$self == 1),], refresh = 0, family = "binomial")
# Regression for average treatment effects of a conservative, liberal, and congression conservative cue among Independents:
# With each of the regressions, we see data filtered for Independents:
#conservative treatment
model1ind <- stan_glm(Support ~ contrump, data = data[data$republican == 0 & data$democrat == 0 & (data$contrump == 1 | data$self == 1),], refresh = 0, family = "binomial")
#liberal treatment
model2ind <- stan_glm(Support ~ libtrump, data = data[data$republican == 0 & data$democrat == 0 & (data$libtrump == 1 | data$self == 1),], refresh = 0, family = "binomial")
#GOP treatment
model3ind <- stan_glm(support_gop ~ gopleader, data = data[data$republican == 0 & data$democrat == 0 & (data$gopleader == 1 | data$self == 1),], refresh = 0, family = "binomial")
```

```{r}
# CONSERVATIVE CUE ON REPS, DEMS, INDS
# Here, I pull the effect of the conservative cue on each political group by simulating the models 
mod1 <- posterior_linpred(model1, transform = TRUE)
mod1dem <- posterior_linpred(model1dem, transform = TRUE)
mod1ind <- posterior_linpred(model1ind, transform = TRUE)
# median prediction of the posterior_linpred for the cons cue:
mm1 <- median(mod1[,2])
mm1dem <- median(mod1dem[,2])
mm1ind <- median(mod1ind[,2])
conservative.treat <- c(mm1, mm1dem, mm1ind)
# Here's the uncertainty for each prediction for the conservative cue's effect on each political group using posterior_linpred:
mm1q2 <- quantile(mod1[,2], probs = c(0.025))
mm1qdem2 <- quantile(mod1dem[,2], probs = c(0.025))
mm1qind2 <- quantile(mod1ind[,2], probs = c(0.025))
mm1q9 <- quantile(mod1[,2], probs = c(0.975))
mm1qdem9 <- quantile(mod1dem[,2], probs = c(0.975))
mm1qind9 <- quantile(mod1ind[,2], probs = c(0.975))
lower.cons<- c(mm1q2, mm1qdem2, mm1qind2)
upper.cons <- c(mm1q9, mm1qdem9, mm1qind9)

# LIBERAL CUE ON REPS, DEMS, INDS
# Here, I pull the effect of the conservative cue on each political group by simulating the models 
mod2 <- posterior_linpred(model2, transform = TRUE)
mod2dem <- posterior_linpred(model2dem, transform = TRUE)
mod2ind <- posterior_linpred(model2ind, transform = TRUE)
# median prediction of the posterior_linpred for the cons cue:
mm2 <- median(mod2[,2])
mm2dem <- median(mod2dem[,2])
mm2ind <- median(mod2ind[,2])
liberal.treat <- c(mm2, mm2dem, mm2ind)
# Here's the uncertainty for each prediction for the conservative cue's effect on each political group using posterior_linpred:
mm2q2 <- quantile(mod2[,2], probs = c(0.025))
mm2qdem2 <- quantile(mod2dem[,2], probs = c(0.025))
mm2qind2 <- quantile(mod2ind[,2], probs = c(0.025))
mm2q9 <- quantile(mod2[,2], probs = c(0.975))
mm2qdem9 <- quantile(mod2dem[,2], probs = c(0.975))
mm2qind9 <- quantile(mod2ind[,2], probs = c(0.975))
lower.liberal <- c(mm2q2, mm2qdem2, mm2qind2)
upper.liberal <- c(mm2q9, mm2qdem9, mm2qind9)

# GOP CUE 
# Here, I pull the effect of the conservative cue on each political group by simulating the models 
mod3 <- posterior_linpred(model3, transform = TRUE)
mod3dem <- posterior_linpred(model3dem, transform = TRUE)
mod3ind <- posterior_linpred(model3ind, transform = TRUE)
# median prediction of the posterior_linpred for the cons cue:
mm3 <- median(mod3[,3])
mm3dem <- median(mod3dem[,3])
mm3ind <- median(mod3ind[,3])
gop.treat <- c(mm3, mm3dem, mm3ind)
# Here's the uncertainty for each prediction for the conservative cue's effect on each political group using posterior_linpred:
mm3q2 <- quantile(mod3[,3], probs = c(0.025))
mm3qdem2 <- quantile(mod3dem[,3], probs = c(0.025))
mm3qind2 <- quantile(mod3ind[,3], probs = c(0.025))
mm3q9 <- quantile(mod3[,3], probs = c(0.975))
mm3qdem9 <- quantile(mod3dem[,3], probs = c(0.975))
mm3qind9 <- quantile(mod3ind[,3], probs = c(0.975))
lower.gop <- c(mm3q2, mm3qdem2, mm3qind2)
upper.gop <- c(mm3q9, mm3qdem9, mm3qind9)

# This standardizes the spacing and divisions in the figure
a <- c(.8, 1, 1.2)
# I deleted this portion becauase it "mutes" the figure
#dev.off()
# This plots the corresponding coefficients
plot(a, liberal.treat, pch = c(15, 16, 17), axes = F, xlab = "Treatment Condition", ylab = "Increased Probability of Voting for Liberal Policy", ylim = c(0, 1), col  = c("dark red", "dark blue", "dark green"), xlim = c(.7, 3.3), cex = 1, main = "Average Treatment Effect of Policy Cues")
segments(x0 = a, y0 = lower.liberal, x1 = a, y1 = upper.liberal)
points(a+1, conservative.treat, pch = c(15, 16, 17), col  = c("dark red", "dark blue", "dark green"), cex = 1)
segments(x0 = a+1, y0 = lower.cons, x1 = a+1, y1 = upper.cons)
points(a+2, gop.treat, pch = c(15, 16, 17), col  = c("dark red", "dark blue", "dark green"), cex = 1)
segments(x0 = a+2, y0 = lower.gop, x1 = a+2, y1 = upper.gop)
# x-axis labels
axis(1, at = c(1,2,3), labels = c("Liberal Trump", "Conservative Trump", "Republicans\n in Congress"), cex.axis = .8)
axis(2, at = seq(0, 1, 0.5), las = 2, cex.axis = .8)
# dashled lines 
#abline(h = 0, lty = 2)
abline(v = seq(1.5, 3.5, 1), lty = 2, col = "grey")
# This labels the points in the first panel
# text(2.8,.28, "comparison group is no cue")
text(1, .5, "Republicans", cex = .7)
text(.82, .85, "Democrats", cex = .7)
text(1.4, .6, "Independents", cex = .7)
box()
```

Next, I plan to expand on the findings in Figure 3: Average Treatment Effect by Republican Party Strength. This figure deals with the sub-hypothesis that states: Strong party affiliates that share party with the cue-giver are more likely to be party loyalists. The authors test this hypothesis by running a linear regression that predicts support of a cue with the interaction between partisanship strength and liberal/conservative cues. The figure, however, only takes into account partisanship values from 4-7 (Independent to very Republican) meaning that this model only tests the treatment effect of liberal or conservative cues on Republicans, not Democrats. This makese sense given that the authors are largely looking at the impact Trump has on Republican partisanship throughout the paper. However, they do claim that the phenomenas found in their paper (especially about the disconnect between ideology and partisanship) can occur among Democrats. 



CAPTIONS
1 FIG 1 
, fig.cap= "Each point represents the effect on the policy cue on a political group. The effect is the coefficient extracted from a linear regression that uses conservative of liberal Trump cues (or GOP congressional cues) with a racial control to predict support for a policy. For instance, the first point is the coefficient for the liberal Trump cue when the data was filtered for just Republicans. The vertical axis represents the increased probability of voting for a liberal policy. Positive values indicate a liberal shift while negative values indicate a conservative shift. The black bars represent the 95% confidence interval for each predicted treatment effect. The most significant effects are seen among Republicans when given conservative and liberal Trump cues. I corrected for the mistake on the Republican point under "Republican in Congress" treatment. In the original figure, it was listed as a 0.03 conservative shift. The true effect, however, was 0.008 - a very slight liberal shift indicative of little to no effect from a GOP cue on Republicans. Below is a screenshot of the original figure in the paper for comparison."

2 KNOWLEDGE REP
fig.cap= "The points in the left pannel represent the effect of a Trump policy cue on varying levels of self-reported political knowledge among Republicans. The right panel looks at the effect of a conservative cue and the left looks at the effect of a liberal cue. The effect is the coefficient extracted from a linear regression that uses conservative Trump cues with a racial control to predict support for a policy. The vertical axis represents the increased probability of voting for a liberal policy. Positive values indicate a liberal shift while negative values indicate a conservative shift. The horizontal axis represents increasing political knowledge. The black bars represent the 95 percent confidence interval for each predicted treatment effect. This figure indicates that Republicans with more self-reported political knowledge are less likely to be swayed by a Trump cue and are especially unlikely to support a liberal statement from the President."

PARTISAN

fig.cap= "This figure looks at the effect of Trump cues on Republicans at different levels of self-reported partisanship. The left panel represents a conservative cue and the right represents a liberal cue. The effect of the cue is the coefficient extracted from a linear regression that uses conservative (or liberal) Trump cues with a racial control to predict support for a policy. The vertical axis represents the increased probability of voting for a liberal policy. Positive values indicate a liberal shift while negative values indicate a conservative shift. The horizontal axis represents increasing partisanship. The black bars represent the 95 percent confidence interval for each predicted treatment effect. The figure shows that Republicans with stronger partisanship are most likely to support a Trump cue, whether conservative or liberal."


2 PARTISAN EXPANSION
, fig.cap= "The points in the left pannel represent the effect of a liberal Trump policy cue on varying levels of Democratic partisanship. The points in the right pannel represent the effect of a conservative Trump policy cue on varying levels of Democratic partisanship. The effect is the coefficient extracted from a linear regression that uses liberal (or conservative) Trump cues with a racial control to predict support for a policy. The vertical axis represents the increased probability of voting for a liberal policy. Positive values indicate a liberal shift while negative values indicate a conservative shift. The horizontal axis represents increasing partisanship. The black bars represent the 95 percent confidence interval for each predicted treatment effect. Unlike the original figure, I use Democratic partisanship on the horizontal axis rather than Republican partisanship. That is, I am testing the effect of a Trump cue on different levels of Democrats. Below is a screenshot of the original figure in the paper for comparison."


3
, fig.cap= "The points in the left pannel represent the effect of a liberal Trump policy cue on varying levels of Republican partisanship. The effect is the coefficient extracted from a linear regression that uses liberal Trump cues with a racial control to predict support for a policy. The points in the right pannel represent the effect of a conservative Trump policy cue on varying levels of Republican partisanship. The effect is the coefficient extracted from a binomial regression that uses conservative Trump cues with a racial control to predict support for a policy. The vertical axis represents the increased probability of voting for a liberal policy. Positive values indicate a liberal shift while negative values indicate a conservative shift. The horizontal axis represents increasing partisanship. The black bars represent the 95% confidence interval for each predicted treatment effect. Unlike the original figure, I use a binomial regression as the prediction of policy support is binomial. I also use a prosterior linear prediction to predict treatment effects and to construct the 95% intervals. Below is a screenshot of the original figure in the paper for comparison."


4
, fig.cap = "This table documents the linear regressions performed throughout the study and includes their standard errors in parentheses. There is a column for each hypothesis: knowledge, party strength, Trump approval, and ideology. Support of a policy is predicted using these variables as well as the interaction models in the first column."

```{r figure 1, include=FALSE}
# We are looking to see the effect of different cues (liberal, conservative, and conservative from congress) on Republicans, Democrats, and Independents. 
# Regression for average treatment effects of a conservative, liberal, and congression conservative cue among Republicans:
# With each of the regressions, we see data filtered for Republicans:
#conservative treatment
model1 <- lm(Support ~ race_white + contrump, data = data[data$republican == 1 & (data$contrump == 1 | data$self == 1),])
#liberal treatment
model2 <- lm(Support ~ race_white + libtrump, data = data[data$republican == 1 & (data$libtrump == 1 | data$self == 1),])
#GOP treatment
model3 <- lm(support_gop ~ race_white + gopleader, data = data[data$republican == 1 & (data$gopleader == 1 | data$self == 1),])
# ****MISTAKE**** in the paper, figure 1 has the treatment effect of about -0.03 on the conservatives yet the outcome is 0.008
# Regression for average treatment effects of a conservative, liberal, and congression conservative cue among Democrats:
# With each of the regressions, we see data filtered for Democrats:
#conservative treatment
model1dem <- lm(Support ~ race_white + contrump, data = data[data$democrat == 1 & (data$contrump == 1 | data$self == 1),])
#liberal treatment
model2dem <- lm(Support ~ race_white + libtrump, data = data[data$democrat == 1 & (data$libtrump == 1 | data$self == 1),])
#GOP treatment
model3dem <- lm(support_gop ~ race_white + gopleader, data = data[data$democrat == 1 & (data$gopleader == 1 | data$self == 1),])
# Regression for average treatment effects of a conservative, liberal, and congression conservative cue among Independents:
# With each of the regressions, we see data filtered for Independents:
#conservative treatment
model1ind <- lm(Support ~ race_white + contrump, data = data[data$republican == 0 & data$democrat == 0 & (data$contrump == 1 | data$self == 1),])
#liberal treatment
model2ind <- lm(Support ~ race_white + libtrump, data = data[data$republican == 0 & data$democrat == 0 & (data$libtrump == 1 | data$self == 1),])
#GOP treatment
model3ind <- lm(support_gop ~ race_white + gopleader, data = data[data$republican == 0 & data$democrat == 0 & (data$gopleader == 1 | data$self == 1),])
# Here, the authors pull the effect of the conservative cue on each political group: 
conservative.treat <- c(model1$coef[3], model1dem$coef[3], model1ind$coef[3])
# Here's the standard error for the conservative cue's effect on each political group:
conservative.se <- c(coef(summary(model1))[, "Std. Error"][3], coef(summary(model1dem))[, "Std. Error"][3], coef(summary(model1ind))[, "Std. Error"][3])
# This creates confidence intervals for the effect of conservative cues on each group:
lower.cons <- conservative.treat - 1.96*conservative.se
upper.cons <- conservative.treat + 1.96*conservative.se
# Here, the authors pull the effect of the liberal cue on each political group:
liberal.treat <- c(model2$coef[3], model2dem$coef[3], model2ind$coef[3])
# Here's the standard error for the liberal cue's effect on each political group:
liberal.se <- c(coef(summary(model2))[, "Std. Error"][3], coef(summary(model2dem))[, "Std. Error"][3], coef(summary(model2ind))[, "Std. Error"][3])
# This creates confidence intervals for the effect of liberal cues on each group:
lower.liberal <- liberal.treat - 1.96*liberal.se
upper.liberal <- liberal.treat + 1.96*liberal.se
# Here, the authors pull the effect of the GOP congressional cue on each political group:
gop.treat <- c(model3$coef[3], model3dem$coef[3], model3ind$coef[3])
# Here's the standard error for the GOP congressional cue effect on each political group:
gop.se <- c(coef(summary(model3))[, "Std. Error"][3], coef(summary(model3dem))[, "Std. Error"][3], coef(summary(model3ind))[, "Std. Error"][3])
# This creates confidence intervals for the effect of the GOP congressional cue on each group:
lower.gop <- gop.treat - 1.96*gop.se
upper.gop <- gop.treat + 1.96*gop.se
# This standardizes the spacing and divisions in the figure
a <- c(.8, 1, 1.2)
# I deleted this portion becauase it "mutes" the figure
#dev.off()
# This plots the corresponding coefficients
plot(a, liberal.treat, pch = c(15, 16, 17), axes = F, xlab = "Treatment Condition", ylab = "Increased Probability of Voting for Liberal Policy", ylim = c(-.21, .21), col  = c("dark red", "dark blue", "dark green"), xlim = c(.7, 3.3), cex = 1.5, main = "Average Treatment Effect of Policy Cues")
segments(x0 = a, y0 = lower.liberal, x1 = a, y1 = upper.liberal)
points(a+1, conservative.treat, pch = c(15, 16, 17), col  = c("dark red", "dark blue", "dark green"), cex = 1.5)
segments(x0 = a+1, y0 = lower.cons, x1 = a+1, y1 = upper.cons)
points(a+2, gop.treat, pch = c(15, 16, 17), col  = c("dark red", "dark blue", "dark green"), cex = 1.5)
segments(x0 = a+2, y0 = lower.gop, x1 = a+2, y1 = upper.gop)
# x-axis labels
axis(1, at = c(1,2,3), labels = c("Liberal Trump", "Conservative Trump", "Republicans\n in Congress"), cex.axis = .8)
axis(2, at = seq(-.2, .2, .05), las = 2, cex.axis = .8)
# dashled lines 
abline(h = 0, lty = 2)
abline(v = seq(1.5, 3.5, 1), lty = 2, col = "grey")
# This labels the points in the first panel
text(2.8,.28, "comparison group is no cue")
text(1, .16, "Republicans", cex = .7)
text(.82, -.01, "Democrats", cex = .7)
text(1.4, .04, "Independents", cex = .7)
box()
```

```{r figure 2, include=FALSE}
# This code will culminate in plot that looks at the treatment effect (political cue) on those with varying political knowledge. # The hypothesis here states: Only the those with less knowledge should react to the cue and behave as party loyalists presumably because the knowledgeable gain little from the treatment (political cue).
# Model 1 is a linear regression that looks that the impact of political knowledge on response to cues. The authors include an interaction between liberal cues and knowledge as well as conservative cues and knowledge to see if there is any discrepancy between cues' effects with knowledge:
model1 <- lm(Support ~ race_white + libtrump*knowledge + contrump*knowledge, data = data[(data$contrump == 1 | data$self == 1 | data$libtrump == 1),])
#control: there is no cue in this data table
newdata = as.data.frame(cbind(rep(1, 9), rep(0, 9), rep(0, 9), seq(0, 8, 1)))
colnames(newdata) <- c("race_white", "contrump", "libtrump", "knowledge")
#conservative treatment: this data table contains a conservative cue for each level of knowledge
newdata1 = as.data.frame(cbind(rep(1, 9), rep(1, 9), rep(0,9), seq(0, 8, 1)))
colnames(newdata1) <- c("race_white", "contrump", "libtrump", "knowledge")
# This table predicts the response at each level of knowledge given no cue.
plx0 <- predict(model1, newdata = newdata, type = "response", se = T)
# This table predicts the response at each level of knowledge given a conservative cue.
plx1 <- predict(model1, newdata = newdata1, type = "response", se = T)
# NOT REALLY SURE WHY THE MODEL1 IS USED IN FIRST PREDICT - WHAT DOES PLX0 DO?
# This is the treatment effect: the difference between response at each knowledge level with a conservative cue and a response at teach knowledge level with a cue. It is the causal effect of the conservative treatment.
diff.cons <- plx1$fit - plx0$fit
# This is the standard error of both predictions and will serve as the "whiskers" in the plot:
diff.cons.se <- sqrt(plx1$se.fit^2 + plx0$se.fit^2)
# These are the upper and lower confidence levels that will be plotted:
upper.cons <- diff.cons + 1.96*diff.cons.se
lower.cons <- diff.cons - 1.96*diff.cons.se
par(mfrow = c(1, 2)) 
#dev.new(width = 4.5, height = 7)
# This plots the diff.cons (the causal effect of a conservative cue at each level of knowledge) with the upper and lower confidence intervals crafted with the standard error. The function also gives the range of the plots, the titles, and the axes. 
# These are just the points, titles, and axes:
plot(seq(0, 8, 1), diff.cons, ylim = c(-.25, .15), pch = 16, ylab = "Estimated Average Treatment Effect", xlab = "Level of Political Knowledge", axes = F, main = "Conservative Trump Treatment")
#This adds on the upper and lower confidence intervals showing the uncertainty of the estimate. It also designates the color of the bars denoting uncertainty:
segments(x0 = c(seq(0, 8, 1), x1 = seq(0, 8, 1)), y0 = lower.cons, y1 = upper.cons, col = "#d17b7b80", lwd = 2)
# This brings the points back in front of the lines of uncertainty:
points(seq(0, 8, 1), diff.cons, pch = 16)
abline(h = 0)
# This adds an axis at zero:
axis(1, at = seq(0, 8, 1))
# This adds the y-axis and denotes the range:
axis(2, at = seq(-.25, .15, .05), las = 2)
# This puts a border around the plot:
box()
# Now we are looking at the liberal cue's causal effect at each interval of knowledge:
#liberal treatment
# This data frame designates the liberal cue for each level of knowledge:
newdata1 = as.data.frame(cbind(rep(1, 9), rep(0, 9), rep(1,9), seq(0, 8, 1)))
colnames(newdata1) <- c("race_white", "contrump", "libtrump", "knowledge")
# This table predicts the response at each level of knowledge given no cue.
plx0 <- predict(model1, newdata = newdata, type = "response", se = T)
# This table predicts the response at each level of knowledge given a liberal cue.
plx1 <- predict(model1, newdata = newdata1, type = "response", se = T)
# This is the treatment effect: the difference between response at each knowledge level with a liberal cue and a response at teach knowledge level with a cue. It is the causal effect of the liberal treatment.
diff.lib <- plx1$fit - plx0$fit
# This is the standard error of both predictions and will serve as the "whiskers" in the plot:
diff.lib.se <- sqrt(plx1$se.fit^2 + plx0$se.fit^2)
# These are the upper and lower confidence levels that will be plotted:
upper.lib <- diff.lib + 1.96*diff.lib.se
lower.lib <- diff.lib - 1.96*diff.lib.se
# the plotting here is the SAME as above
#dev.new(width = 4.5, height = 7)
plot(seq(0, 8, 1), diff.lib, ylim = c(-.25, .15), pch = 16, ylab = "Estimated Average Treatment Effect", xlab = "Level of Political Knowledge", axes = F, main = "Liberal Trump Treatment")
segments(x0 = c(seq(0, 8, 1), x1 = seq(0, 8, 1)), y0 = lower.lib, y1 = upper.lib, col = "#4286f480", lwd = 2)
points(seq(0, 8, 1), diff.lib, pch = 16)
abline(h = 0)
axis(1, at = seq(0, 8, 1))
axis(2, at = seq(-.25, .15, .05), las = 2)
box()
```

```{r figure 3, include=FALSE}
# This code will culminate in plot that looks at the treatment effect (political cue) on those with varying partisan affiliation. 
# The hypothesis here states: Strong party affiliates that share party with the cue-giver are more likely to be party loyalists.
# This model is the basis of the predictions and will help determine the causal effect of political cues on different levels of partisanship among Republicans. This model estimates support of policy based on race and the interaction between cues (conservative and liberal) and political ideology:
model1 <- lm(Support ~ race_white + libtrump*pid7 + contrump*pid7, data = data[(data$contrump == 1 | data$self == 1 | data$libtrump == 1) & data$pid7 %in% c(4, 5, 6, 7),])
# This data table serves as the control - the baseline for comparison. There is no cue in this data table:
newdata = as.data.frame(cbind(rep(1, 4), rep(0, 4), rep(0, 4), seq(4, 7, 1)))
colnames(newdata) <- c("race_white", "contrump", "libtrump", "pid7")
#conservative treatment: The effect of a conservative cue on those who identify with a conservative party at different degrees (pid7 = 4-7)
newdata1 = as.data.frame(cbind(rep(1, 4), rep(1, 4), rep(0, 4), seq(4, 7, 1)))
colnames(newdata1) <- c("race_white", "contrump", "libtrump", "pid7")
# These are predictions of the level of support at each Republican partisan level given the data table above with no cue:
plx0 <- predict(model1, newdata = newdata, type = "response", se = T)
#These are predictions of the level of support of a cue at each Republican partisan level given a conservative cue:
plx1 <- predict(model1, newdata = newdata1, type = "response", se = T)
# This estimates the causal effect of cues on different levels of Republican partisanship:
diff.cons <- plx1$fit - plx0$fit
# This is the staandard error of the estimates causal effects:
diff.cons.se <- sqrt(plx1$se.fit^2 + plx0$se.fit^2)
# These are the upper and lower confidence intervals the causal effect. They are calculated by adding and subtract a standard deviation times the standard error calculated above:
# IS THIS A CONF INTERVAL, 95%?, 65%?:
upper.cons <- diff.cons + 1.96*diff.cons.se
lower.cons <- diff.cons - 1.96*diff.cons.se
# plots next to each other
par(mfrow = c(1, 2)) 
# This chunk plots the causal effects the same way that figure 2 did, but with partisanship on the x-axis:
#dev.new(width = 4.5, height = 7)
plot(seq(4, 7, 1), diff.cons, ylim = c(-.25, .25), pch = 16, ylab = "Estimated Average Treatment Effect", xlab = "Level of Partisan Affilitation", axes = F, main = "Conservative Trump Treatment")
segments(x0 = c(seq(4, 7, 1), x1 = seq(4, 7, 1)), y0 = lower.cons, y1 = upper.cons, col = "#d17b7b80", lwd = 2)
points(seq(4, 7, 1), diff.cons, pch = 16)
abline(h = 0)
axis(1, at = seq(4, 7, 1), labels = c("Independent", "Lean GOP", "Weak GOP", "Strong GOP"), cex.axis = .8)
axis(2, at = seq(-.45, .25, .05), las = 2)
box()
# The same steps as above are repeated here, but using the liberal cue as treatment on Republican partisans:
newdata1 = as.data.frame(cbind(rep(1, 4), rep(1, 4), rep(0, 4), rep(0, 4), rep(1, 4), seq(4, 7, 1)))
colnames(newdata1) <- c("race_white", "republican", "democrat", "contrump", "libtrump", "pid7")
# Like above, these are the predictions for the control and for the treatment:
plx0 <- predict(model1, newdata = newdata, type = "response", se = T)
plx1 <- predict(model1, newdata = newdata1, type = "response", se = T)
# Here we calculate the causal effect and the standard error:
diff.lib <- plx1$fit - plx0$fit
diff.lib.se <- sqrt(plx1$se.fit^2 + plx0$se.fit^2)
# These are the upper and lower confidence intervals:
upper.lib <- diff.lib + 1.96*diff.lib.se
lower.lib <- diff.lib - 1.96*diff.lib.se
# Here is the plot:
#dev.new(width = 4.5, height = 7)
plot(seq(4, 7, 1), diff.lib, ylim = c(-.25, .25), pch = 16, ylab = "Estimated Average Treatment Effect", xlab = "Levels of Partisan Affiliation", axes = F, main = "Liberal Trump Treatment")
segments(x0 = c(seq(4, 7, 1), x1 = seq(4, 7, 1)), y0 = lower.lib, y1 = upper.lib, col = "#4286f480", lwd = 2)
points(seq(4, 7, 1), diff.lib, pch = 16)
abline(h = 0)
axis(1, at = seq(4, 7, 1), labels = c("Independent", "Lean GOP", "Weak GOP", "Strong GOP"), cex.axis = .8)
axis(2, at = seq(-.25, .45, .05), las = 2)
box()
```

```{r figure 4, include=FALSE}
# This code will culminate in plot that looks at the treatment effect (political cue) on those with varying approval levels of Trump. 
# The hypothesis here states: Those who approve of the cue-giver should be more likely to be party loyalists. 
# This model is the basis of the predictions and will help determine the causal effect of political cues on different levels of approval of Trump. This model estimates support of policy based on race and the interaction between cues (conservative and liberal) and approval:
model1 <- lm(Support ~ race_white + libtrump*trump_approve + contrump*trump_approve, data = data[(data$contrump == 1 | data$self == 1 | data$libtrump == 1),])
# This data table serves as the control - the baseline for comparison. There is no cue in this data table:
newdata = as.data.frame(cbind(rep(1, 5), rep(0, 5), rep(0, 5), seq(1, 5, 1)))
colnames(newdata) <- c("race_white", "contrump", "libtrump", "trump_approve")
# conservative treatment: The effect of a conservative cue on those who identify with a conservative party with differing levels of Trump approval:
newdata1 = as.data.frame(cbind(rep(1, 5), rep(1, 5), rep(0, 5), seq(1, 5, 1)))
colnames(newdata1) <- c("race_white", "contrump", "libtrump", "trump_approve")
# These are predictions of the level of support at each approval level given the data table above with no cue:
plx0 <- predict(model1, newdata = newdata, type = "response", se = T)
# These are predictions of the level of support of a cue at each level of Trump approval given a conservative cue:
plx1 <- predict(model1, newdata = newdata1, type = "response", se = T)
# Here we calculate the causal effect and the standard error:
diff.cons <- plx1$fit - plx0$fit
diff.cons.se <- sqrt(plx1$se.fit^2 + plx0$se.fit^2)
# These are the upper and lower confidence intervals:
upper.cons <- diff.cons + 1.96*diff.cons.se
lower.cons <- diff.cons - 1.96*diff.cons.se
par(mfrow = c(1, 2)) 
# Here is the plot of the treatment effect of a conservative cue on different levels of Trump approval (the steps are almost the same as those in previous figures):
#dev.new(width = 4.5, height = 7)
plot(seq(1, 5, 1), diff.cons, ylim = c(-.15, .22), pch = 16, ylab = "Estimated Average Treatment Effect", xlab = "Level of Trump Approval", axes = F, main = "Conservative Trump Treatment")
segments(x0 = c(seq(1, 5, 1), x1 = seq(1, 5, 1)), y0 = lower.cons, y1 = upper.cons, col = "#d17b7b80", lwd = 2)
points(seq(1, 5, 1), diff.cons, pch = 16)
abline(h = 0)
axis(1, at = seq(1, 5, 1), labels = c("Strongly\nDisapprove", "", "Neutral", "", "Strongly\nApprove"), cex.axis = .8)
axis(2, at = seq(-.25, .25, .05), las = 2)
box()
# liberal treatment: The effect of a liberal cue on those who identify with a conservative party with differing levels of Trump approval:
newdata1 = as.data.frame(cbind(rep(1, 5), rep(1, 5), rep(0, 5), rep(0, 5), rep(1, 5), seq(1, 5, 1)))
colnames(newdata1) <- c("race_white", "republican", "democrat", "contrump", "libtrump", "trump_approve")
# predictions with anad without cue given the previous regression model:
plx0 <- predict(model1, newdata = newdata, type = "response", se = T)
plx1 <- predict(model1, newdata = newdata1, type = "response", se = T)
# The causal effect of liberal treatment and standard error:
diff.lib <- plx1$fit - plx0$fit
diff.lib.se <- sqrt(plx1$se.fit^2 + plx0$se.fit^2)
# Confidence intervals:
upper.lib <- diff.lib + 1.96*diff.lib.se
lower.lib <- diff.lib - 1.96*diff.lib.se
# Here is the plot of the treatment effect of a liberal on different levels of Trump approval (the steps are almost the same as those in previous figures):
#dev.new(width = 4.5, height = 7)
plot(seq(1, 5, 1), diff.lib, ylim = c(-.15, .22), pch = 16, ylab = "Estimated Average Treatment Effect", xlab = "Level of Trump Approval", axes = F, main = "Liberal Trump Treatment")
segments(x0 = c(seq(1, 5, 1), x1 = seq(1, 5, 1)), y0 = lower.lib, y1 = upper.lib, col = "#4286f480", lwd = 2)
points(seq(1, 5, 1), diff.lib, pch = 16)
abline(h = 0)
axis(1, at = seq(1, 5, 1), labels = c("Strongly\nDisapprove", "", "Neutral", "", "Strongly\nApprove"), cex.axis = .8)
axis(2, at = seq(-.25, .25, .05), las = 2)
box()
```

```{r figure 5, include=FALSE}
# This code will culminate in plot that looks at the treatment effect (political cue) on those with varying ideologies. 
# The hypothesis here states: Self-described conservatives should hold firm to their presumed beliefs and are less likely to be party loyalists because they stick with their self-described policy tenets.
# The steps here are the same as those above, just using ideology. I will not go through each in detail.
model1 <- lm(Support ~ race_white + libtrump*ideo5b + contrump*ideo5b, data = data[(data$contrump == 1 | data$self == 1 | data$libtrump == 1),])
#control
newdata = as.data.frame(cbind(rep(1, 5), rep(0, 5), rep(0, 5), seq(1, 5, 1)))
colnames(newdata) <- c("race_white", "contrump", "libtrump", "ideo5b")
#conservative treatment
newdata1 = as.data.frame(cbind(rep(1, 5), rep(1, 5), rep(0, 5), seq(1, 5, 1)))
colnames(newdata1) <- c("race_white", "contrump", "libtrump", "ideo5b")
# predictions of treatment effect 
plx0 <- predict(model1, newdata = newdata, type = "response", se = T)
plx1 <- predict(model1, newdata = newdata1, type = "response", se = T)
# causal effect and se:
diff.cons <- plx1$fit - plx0$fit
diff.cons.se <- sqrt(plx1$se.fit^2 + plx0$se.fit^2)
# confidence intervals:
upper.cons <- diff.cons + 1.96*diff.cons.se
lower.cons <- diff.cons - 1.96*diff.cons.se
par(mfrow = c(1, 2)) 
# plots
#dev.new(width = 4.5, height = 7)
plot(seq(1, 5, 1), diff.cons, ylim = c(-.16, .16), pch = 16, ylab = "Estimated Average Treatment Effect", xlab = "Self-Placed Ideology", axes = F, main = "Conservative Trump Treatment")
segments(x0 = c(seq(1, 5, 1), x1 = seq(1, 5, 1)), y0 = lower.cons, y1 = upper.cons, col = "#d17b7b80", lwd = 2)
points(seq(1, 5, 1), diff.cons, pch = 16)
abline(h = 0)
axis(1, at = seq(1, 5, 1), labels = c("Strong\nLiberal", "", "Moderate", "", "Strong\nConservative"), cex.axis = .8)
axis(2, at = seq(-.25, .25, .05), las = 2)
box()
# same steps, just with liberal cue
#liberal treatment
newdata1 = as.data.frame(cbind(rep(1, 5), rep(0, 5), rep(1, 5), seq(1, 5, 1)))
colnames(newdata1) <- c("race_white", "contrump", "libtrump", "ideo5b")
plx0 <- predict(model1, newdata = newdata, type = "response", se = T)
plx1 <- predict(model1, newdata = newdata1, type = "response", se = T)
diff.lib <- plx1$fit - plx0$fit
diff.lib.se <- sqrt(plx1$se.fit^2 + plx0$se.fit^2)
upper.lib <- diff.lib + 1.96*diff.lib.se
lower.lib <- diff.lib - 1.96*diff.lib.se
#dev.new(width = 4.5, height = 7)
plot(seq(1, 5, 1), diff.lib, ylim = c(-.16, .16), pch = 16, ylab = "Estimated Average Treatment Effect", xlab = "Self-Placed Ideology", axes = F, main = "Liberal Trump Treatment")
segments(x0 = c(seq(1, 5, 1), x1 = seq(1, 5, 1)), y0 = lower.lib, y1 = upper.lib, col = "#4286f480", lwd = 2)
points(seq(1, 5, 1), diff.lib, pch = 16)
abline(h = 0)
axis(1, at = seq(1, 5, 1), labels = c("Strong\nLiberal", "", "Moderate", "", "Strong\nConservative"), cex.axis = .8)
axis(2, at = seq(-.25, .25, .05), las = 2)
box()
```
